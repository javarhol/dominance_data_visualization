"0","#subset males and females"
"0","males <- filter(ranks_per_week, sex == ""Male"")"
"0","females <- filter(ranks_per_week, sex == ""Female"")"
"0",""
"0","male_plot <- ggplot(males, aes(day, rank, group = animal_id, color = as.factor(cage_rank), label = animal_id)) +"
"0","  geom_line(linewidth = 1, aes(y=jitter(rank, .5))) +"
"0","  scale_x_discrete(labels = c(""d1"" = 1, ""d2"" = 2, ""d3"" = 3), expand = c(0,0)) +"
"0","  scale_y_reverse(breaks = c(1,2,3,4,5), labels = c(""Alpha"", ""Beta"", ""Gamma"", ""Delta"", ""Epsilon""), expand = c(0,0)) +"
"0","  scale_color_social() + guides(colour=""none"") +"
"0","  ggtitle(""Males"") +"
"0","  xlab(""Week"") + ylab("""") +"
"0","  theme_minimal_vgrid()"
"0",""
"0","female_plot <- ggplot(females, aes(day, rank, group = animal_id, color = as.factor(cage_rank), label = animal_id)) +"
"0","  geom_line(linewidth = 1, aes(y=jitter(rank, .5))) +"
"0","  scale_x_discrete(labels = c(""d1"" = 1, ""d2"" = 2, ""d3"" = 3), expand = c(0,0)) +"
"0","  scale_y_reverse(breaks = c(1,2,3,4,5), labels = c(""Alpha"", ""Beta"", ""Gamma"", ""Delta"", ""Epsilon""), expand = c(0,0)) +"
"0","  scale_color_social() + guides(colour=""none"") +"
"0","  ggtitle(""Females"") +"
"0","  xlab(""Week"") + ylab("""") +"
"0","  theme_minimal_vgrid()"
"0",""
"0","#make stability dataset"
"0","stability <- ranks_per_week %>% "
"0","  select(cage_id, animal_id, sex, cage_rank, day, rank) %>% "
"0","  pivot_wider(names_from = day, values_from = rank) %>% "
"0","  mutate(stability = case_when("
"0","    d1 == d2 & d2 == d3 ~ ""stable"","
"0","    d1 != d2 ~ ""unstable"","
"0","    d1 != d3 ~ ""unstable"","
"0","    d2 != d3 ~ ""unstable"""
"0","  )) %>% "
"0","  filter(stability == ""stable"")"
"0",""
"0","#make stability histograms of only stable animals"
"0","males <- stability %>% "
"0","  filter(sex == ""Male"") "
"0","females <- stability %>% "
"0","  filter(sex == ""Female"") "
"0",""
"0","male_hist <- ggplot(males, aes(cage_rank)) +"
"0","  geom_bar() + "
"0","  geom_hline(yintercept = 1:7,"
"0","             color = ""white"", linewidth = 1) +"
"0","  scale_x_reverse() + coord_flip() +"
"0","  xlab("""") + ylab("""")+"
"0","  theme_nothing()"
"0",""
"0","female_hist <- ggplot(females, aes(cage_rank)) +"
"0","  geom_bar() + "
"0","  geom_hline(yintercept = 1:7,"
"0","             color = ""white"", linewidth = 1) +"
"0","  scale_x_reverse() + coord_flip() +"
"0","  theme_nothing()"
"0","#geom_hline, removes the need for an axis, just make sure that the number of lines (e.g. 1:7) is equal to the highest number of animals for a specific rank. In this case, there were 7 female alphas that remained stable. "
"0",""
"0","#plot everything in panels"
"0","plot_grid(male_plot, male_hist, female_plot + theme(axis.text.y = element_blank()), female_hist, ncol = 4, align = ""h"", rel_widths = c(1.2, .2, 1, .2))"
